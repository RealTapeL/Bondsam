INFO:root:batch_size = 1
INFO:root:device = cuda
INFO:root:epoch = 10
INFO:root:eval_interval = 5
INFO:root:image_size = 224
INFO:root:k_clusters = 20
INFO:root:k_shot = 1
INFO:root:learning_rate = 0.005
INFO:root:memory_cluster_method = kmeans
INFO:root:memory_cluster_size = 32
INFO:root:mode = few_shot
INFO:root:model = ViT-B-16
INFO:root:prompting_branch = VL
INFO:root:prompting_depth = 3
INFO:root:prompting_length = 2
INFO:root:prompting_type = SD
INFO:root:save_fig = False
INFO:root:save_interval = 10
INFO:root:save_path = ./workspaces/bondsam_exp_820
INFO:root:training_data = mvtec
INFO:root:use_fastsam = True
INFO:root:use_hsf = True
INFO:root:use_memory_bank = True
INFO:root:Loading training data...
INFO:root:Training data loaded. Classes: ['bottle', 'cable', 'capsule', 'carpet', 'grid', 'hazelnut', 'leather', 'metal_nut', 'pill', 'screw', 'tile', 'toothbrush', 'transistor', 'wood', 'zipper'], Total samples: 1725
INFO:root:Starting to build Memory Bank for few-shot anomaly detection...
INFO:root:Building Memory Bank with k_shot=1
INFO:root:Memory Bank built with 15 classes
INFO:root:Loading test data...
INFO:root:Test data loaded. Classes: ['bottle', 'cable', 'capsule', 'carpet', 'grid', 'hazelnut', 'leather', 'metal_nut', 'pill', 'screw', 'tile', 'toothbrush', 'transistor', 'wood', 'zipper'], Total samples: 1725
INFO:root:Starting training loop...
INFO:root:Starting epoch 1/10
